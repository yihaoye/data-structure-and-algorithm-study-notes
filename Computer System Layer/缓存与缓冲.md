## Cache 和 Buffer 都是缓存，主要区别是什么？
cache 是为了弥补高速设备和低速设备的鸿沟而引入的中间层，最终起到**加快访问速度**的作用。而 buffer 的主要目的进行流量整形，把突发的大数量较小规模的 I/O 整理成平稳的小数量较大规模的 I/O，以**减少响应次数**（比如从网上下电影，不能下一点点数据就写一下硬盘，而是积攒一定量的数据以后一整块一起写，不然硬盘操作过多）。  
  
> Buffer（缓冲区）是系统两端处理速度平衡（从长时间尺度上看）时使用的。它的引入是为了减小短期内突发 I/O 的影响，起到流量整形的作用。比如生产者 —— 消费者问题，他们产生和消耗资源的速度大体接近，加一个 buffer 可以抵消掉资源刚产生/消耗时的突然变化。  
> Cache（缓存）则是系统两端处理速度不匹配时的一种折衷策略。因为 CPU 和 memory 之间的速度差异越来越大，所以人们充分利用数据的局部性（locality）特征，通过使用存储系统分级（memory hierarchy）的策略来减小这种差异带来的影响。  
> 假定以后存储器访问变得跟 CPU 做计算一样快，cache 就可以消失，但是 buffer 依然存在。比如从网络上下载东西，瞬时速率可能会有较大变化，但从长期来看却是稳定的，这样就能通过引入一个 buffer 使得 OS 接收数据的速率更稳定，进一步减少对磁盘的伤害。  
> TLB（Translation Lookaside Buffer，翻译后备缓冲器）名字起错了，其实它是一个 cache。  
  
无论缓存还是缓冲，其实本质上解决的都是读写速度不匹配的问题，从这个角度，他们非常相似。  
在 read（读取）的场合，cache 通常被用于减少重复读取数据时的开销，而 buffer 则用于规整化每次读取数据的尺寸，在读取场合两者用途差别很大。在 write（写入）的场合，两者功能依然没变，但由于 cache 跟 buffer 的功能在写入场合可以融合使用，所以两者可以被混淆，写入缓冲跟写入缓存往往会同时担当规整化写入尺寸以及减少写入次数的功能，所以两者有时会被混淆，但这只是个名称问题，没有原则性关系。  
write buffer 是 read buffer 的对应，对于小数据的写入，它需要填满 write buffer 再进行一次写入，对于大数据，大数据会被分割到 buffer 尺寸的大小分批写入。因此，write buffer 的用处在于使得每次写入的数据量相对固定。如果一次写入 4k 对某个设备来说效率最高，那么把 buffer 定为 4k，小数据积攒到 4k 写一次，大数据分割到每个碎片 4k 多次写入，这样就是 write buffer 的用处。  
所谓 write cache，就是要设法减少写入次数。也就是说，如果某些数据需要产生多次写入，那么使用 cache 就可以只将最终数据写入，导致最终写入数据减少。在实际应用中，有时会使用到 write buffer 跟 write cache 的合体形态。buffer 本身需要规整尺寸，与此同时，buffer 还允许多次随机写入，使得多次写入的数据只用写入最后一次，这属于 cache 的特性。BT 软件使用的写缓存往往具有类似特性，因而这种形态它同时既是 buffer 又是 cache。正因为在写入场合 buffer 跟 cache 没有那么明显的分界，所以才会有产生 buffer 跟 cache 究竟有啥区别的疑问。  
  
参考：  
https://www.zhihu.com/question/26190832/answer/32387918  
https://www.zhihu.com/question/26190832/answer/830615125  
